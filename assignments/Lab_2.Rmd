---
title: "Lab #2: Data Wrangling"
author: "Data Science and Society (Sociology 367)"
date: ""
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

In this lab we will practice using the `tidyverse` package.

Be sure to do the required readings first. While many of the problems can be solved using approaches from the lecture videos, lab videos, or required readings, you may need to do some searching on the internet to solve some of the problems. This will be a valuable skill to learn as you develop as a data scientist.

This file should be submitted in both R Markdown (.Rmd) file and knitted HTML web page (.html) files, and you should be starting with the Lab markdown file ([link to file](/assignments/Lab_2.Rmd)) where the author name has been replaced with your own. While the R Markdown file should include all of the code you used to generate your solutions, the Knitted HTML file should ONLY display the solutions to the assignment, and NOT the code you used to solve it. Imagine this is a document you will submit to a supervisor or professor - they should be able to reproduce the code/analysis if needed, but otherwise only need to see the results and write-up. This means they should be able to run the R Markdown file to directly generate the same exact html file you submitted. **Submit to your TA via direct message on Slack by the deadline indicated on the course website.**

**Required reading:** 

* [R for Data Science Chapter 5: Data transformation](https://r4ds.had.co.nz/transform.html)

**Optional resources:**

- [R for Data Science (Chapters 9-13)](https://r4ds.had.co.nz/wrangle-intro.html)
- [More dplyr examples](https://rstudio.cloud/learn/primers/2)
- [More help for tidy](https://rstudio.cloud/learn/primers/4)


```{r message=FALSE, echo=FALSE}
# Load the datasets and libraries. You shouldn't need to change the URL in the `load` function.

library(tidyverse)

load('E:\\data\\congress.RData')
```
<br/>

## Questions
<br>


**1. Describe what the following tidyverse functions do. Also describe the pipe operator "%>%". You may need to look up the official documentation for each of these.**

```
filter: 
select: 
mutate: 
count: 
arrange: 
gather: 
pipe operator ("%>%"): 
```
<br/>

**2. Create a new dataframe that includes only senators and the columns `gender`, `birthyear`, and `party`. Then use that new dataframe to compute the number of male and female democrats and republicans (the output should be five rows corresponding to female democrats, male democrats, male independents, female republicans, and male republicans).**

```{r}
# your answer here
tmp <- congress %>% filter(type=='sen') %>% select(gender, party, birthyear)
tmp %>% count(gender, party)
```
<br/>

**3. Identify the oldest and youngest male and female democrat senators.**
```{r}
# your answer here
tmp <- congress %>% 
  filter(type=='sen', party=='Democrat') %>% 
  arrange(birthyear) %>% 
  select(gender, party, birthyear, full_name)
  
tmp %>% filter(gender=='M') %>% head(1) %>% select(full_name)
tmp %>% filter(gender=='F') %>% head(1) %>% select(full_name)

  
```
<br/>

**4. Using `mutate`, create a new variable called `age` which represents the age of each member of congress. How many democratic senators are over 60 years old?**
```{r}
# your answer here
congress %>% 
  mutate(age=2020-birthyear) %>% 
  filter(age >= 60, party=='Democrat') %>% 
  count()
```
<br/>

**5. Create a new column that indicates whether or not the member of congress is more than 55 years old, and create a single dataframe showing the number of male and female members of congress that are over and under 55 (the dataframe should have four rows: number of females over 55, number of males over 55, etc).**
```{r}
# your answer here
congress %>% 
  mutate(is_old=(2020-birthyear)>55) %>% 
  count(is_old, gender)
```
<br/>


**6. Using `gather`, create a new dataframe where each row corresponds to a valid twitter, facebook, or youtube social media account, then compute the total number of accounts for each political party. Then do the same with `pivot_longer`.**

Note: not every congress member has an account on all three platform, so be sure to filter.

Note: you may need to look up the documentation for `pivot_longer`.
```{r}
# your answer here
congress %>% 
  select(twitter:youtube, party, gender) %>% 
  gather(key=platform, value=username, twitter:youtube) %>% 
  filter(!is_null(username)) %>% 
  count(party)
```
<br/>



**Below, I define for you two vectors corresponding to policies that US States have adopted to respond to COVID-19: restrictions on travel ([recorded May 20, 2020](https://www.wsj.com/articles/a-state-by-state-guide-to-coronavirus-lockdowns-11584749351)) and requirements that citizens to wear masks in public ([recorded August 17, 2020](https://www.cnn.com/2020/06/19/us/states-face-mask-coronavirus-trnd/index.html)).**
```{r}
travel_restrictions <- c("WA", "OR", "NV", "CA", "NM", "MN", "IL", "OH", "MI", "PA", "VA", "NY", "MA", "VH", "ME", "DE", "MD", "NJ")

require_masks <- c("HI", "WA", "OR", "NV", "CA", "MT", "CO", "NM", "KS", "TX", "MN", "AR", "LA", "WI", "IL", "AL", "MI", "IN", "OH", "KY", "WV", "NC", "VA", "DC", "DE", "PA", "NY", "VT", "NH", "MA", "RI", "CT", "ME")
```
<br/>

**7. write code to print only the states who implemented travel restrictions and then also required citizens to wear masks in public:**
```{r}
# your answer here
```
<br/>

**8. Write code to print the states who had implemented either policy:**
```{r}
# your answer here
```

