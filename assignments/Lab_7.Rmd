---
title: "Lab #7: Modeling With Statistics"
author: "Data Science and Society (Sociology 367)"
date: ""
output: html_document
---


In this lab, we will practice making statistical models of data using R. Throughout the lab we'll be using these models to understand how Spotify calculates their "popularity" scores assigned to each artist. Edit the Lab #7 markdown file ([link to file](https://github.com/dssoc/dssoc.github.io/raw/master/assignments/Lab_7.Rmd)) for your submission. Remember to change the "author" field above to your name. **Send the markdown file (.Rmd) to your TA via direct message on Slack.** Be sure to do the required reading!

**Required reading:** 

* R for Data Science: [Modeling (Chapters 23-25)](https://r4ds.had.co.nz/model-intro.html)


**Optional reading:** 



### Required Datasets

We will use the following datasets for the exercises.

(1) `artist_meta`: [artist_meta.Rdata](https://github.com/dssoc/dssoc.github.io/raw/master/datasets/artist_meta.Rdata) is a table of Grammy nominee names and some of their spotify metadata.


**Load the datasets and libraries. NOTE! It might be a good idea to convert the `popularity` column to a "double" type here to make later analyses easier. Do that here using the `mutate` and `as.integer` functions.**
```{r message=FALSE}
library(tidyverse)
library(MASS)
load(url('https://dssoc.github.io/datasets/artist_meta.Rdata'))
artist_meta <- artist_meta %>% mutate(popularity=as.integer(popularity))
head(artist_meta)
```
<br/>


## Exercises
<br/>

**1. In your own words, describe what statistical modeling means. When is it used? What does it allow data scientists to do?**

```
# Your answer here
```
<br/>


**2. What is the correlation and statistical significance (measured by p-value) between an artist's popularity and their number of followers on Spotify? Why would this correlation be less than 1.0? Hint: you may find the `cor.test` function helpful. (Note: be sure you have converted the `popularity` column to numeric, as described above.)**
```{r}
# Your answer here
```
<br/>


**3. Create a scatter plot showing the number of followers on the x-axis and artist popularity on the y-axis. Display a trend line on the plot. Can you draw any rough quantitative information about the relationship between these two variables just from this plot?**
```{r}
# Your answer here
```
<br/>


**4. Generate a new column of logical type called `is_pop` to indicate whether a given artist is categorized in any pop genre (e.g. any genre that includes the word "pop", like "rap pop", etc). Create another column named `is_rap` that indicates whether the artist has been included in any "rap" genre. Make summary statistics indicating how many artists fall into either category.**
```{r}
# Your answer here
artist_meta <- artist_meta %>% 
  mutate(is_pop=grepl('pop', genre)) %>% 
  mutate(is_rap=grepl('rap', genre))

artist_meta %>% group_by(is_pop) %>% count()
artist_meta %>% group_by(is_rap) %>% count()

```
<br/>

**5. Compute a measure of the relationship (you may use correlations or chi-squared tests here) between the `is_pop` and `is_rap` variables? What are the relationships with those two variables and Spotify's popularity metric? Which ones are significant? What does that tell us about Spotify's measure of popularity?**
```{r}
# Your answer here
artist_meta <- artist_meta %>% 
  mutate(is_popn=as.numeric(is_pop), is_rapn=as.numeric(is_rap))

chisq.test(table(artist_meta$is_pop, artist_meta$is_rap))
cor.test(artist_meta$is_popn, artist_meta$is_rapn)
cor.test(artist_meta$is_popn, artist_meta$popularity)
cor.test(artist_meta$is_rapn, artist_meta$popularity)
```
<br/>

**6. Use `ggplot` to create [box plots](https://www.r-graph-gallery.com/boxplot.html) or [violin plots](https://www.r-graph-gallery.com/violin.html) showing the popularity by `is_pop` and `is_rap`. What can you say about the data from these plots?**
```{r}
# Your answer here
```
<br/>

**7. Create a multivariate linear model (see the `lm` function) predicting the Spotify popularity measure from both `is_pop` and `is_rap`. Then create a second model that additionally includes the artist's number of followers as a covariate. What do these models tell us? Why would we create a second model that includes the additional variable?**
```{r}
# Your answer here
```
<br/>


**8. Are there other unmeasured variables that might be confounding your models that we were not able to include in the model? For instance, perhaps our measurement pop genre categorization actually captures some other aspect of the song that Spotify uses to generate the measure of popularity. Name *two*.**
```
# Your answer here
```
<br/>

**9. How could you use statistical modeling to answer the hypothesis you provided in the last assignment? What inferences could you make?**
```
# Your answer here
```
<br/>


**10. Describe one or two existing datasets that you would like to use for the project you've been developing last week. Will you be able to download the data from somewhere, or can you use an API? Will you be making statistical models, analyzing networks, doing text analysis, or creating visualizations? See the ["Final Project " section in the course description page on the website](https://dssoc.github.io/course/).**
```
# Your answer here
```
