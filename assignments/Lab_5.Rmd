---
title: "Lab #5: Basics of Social Network Analysis"
author: "Data Science and Society (Sociology 367)"
date: ""
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**[Lab #5 Markdown File](/assignments/Lab_5.Rmd)**

**[Lab Instructions](https://dssoc.github.io/assignments/lab_instructions.html)**

In this lab we will be practicing the fundamentals of network analysis. 

See the "Instructions" section of the [Introduction to Lab Assignments](https://dssoc.github.io/assignments/lab_instructions.html) page for more information about the labs. That page also gives descriptions for the datasets we will be using.

**Required reading:** 

* [R4DS Chapters 17-21: Programming](https://r4ds.had.co.nz/program-intro.html)

* [`igraph` Tutorial](https://igraph.org/python/doc/tutorial/tutorial.html)
* [Bipartite/Two-Mode Networks in igraph by Phil Murphy & Brendan Knapp](https://rpubs.com/pjmurphy/317838)
* [Intro to Network Analysis with R, by Jesse Sadle](https://www.jessesadler.com/post/network-analysis-with-r/). 
* [Network analysis with R and igraph: NetSci X Tutorial (Parts 2-7), by 
Katya Ognyanova](https://kateto.net/networks-r-igraph)


**Optional resources:**

* [Official documentation for `igraph` package](https://igraph.org/r/doc/)
* [Official documentation for `ggraph` package](https://cran.r-project.org/web/packages/ggraph/ggraph.pdf)
* [Introduction to `ggraph` layouts](https://www.data-imaginist.com/2017/ggraph-introduction-layouts/)


```{r message=FALSE, echo=FALSE}
# Load the datasets and libraries. You shouldn't need to change the URL in the `load` function.

library(igraph)
library(ggraph)
library(tidyverse)
library(ggplot2)

load(url('https://dssoc.github.io/datasets/committees.RData'))
load(url('https://dssoc.github.io/datasets/congress.RData'))
```
<br/>

## Questions
<br>

**1. Describe the following concepts using the suggested readings or by searching on the web:**

```

Basic Elements of Networks
  nodes (also called "vertices"): 
  edges (also called "ties" or "links"): 

Network Representations
  edge list: 
  adjacency matrix: 

Types of networks
  directed network: 
  undirected network: 
  weighted network: 
  unweighted network: 
  bipartite network: 
```
<br/>

**2. Describe three different centrality measures (e.g. betweenness, strength, eigenvector, etc) that can be used to summarize the positions of specific nodes/vertices within a network.**
```
1. 
2. 
3. 
```
<br/>

**3. For some of the following problems, we will be working with the `committee_memberships` dataframe. Is this an adjacency matrix or edge list representation? Is the network weighted/unweighted, directed/undirected, bipartite/unipartite?**

HINT: see the Lab Instructions page linked at the top of this assignment for more information about the `committees.Rdata` dataset.
```

Adjacency Matrix or Edge List?

weighted/unweighted?
directed/undirected?
bipartite/unipartite?
```
<br/>


**4. Create a bipartite network representing links between members of congress and the subcommittees (not full committees) they are associated with using the `committee_memberships` dataframe and the `graph_from_data_frame` function (note that you will need to filter out full committee information using the code on the Lab Instructions document). Keep this graph for future problems. You can verify that your network is bipartite using the `is_bipartite` function; show this output as your solution to this question - it should return TRUE.**

HINT: you will again need to join `committee_memberships` with `subcommittees` to remove the full committee memberships. You can just use the code on the Lab Instructions document to do this.

HINT: you can create a bipartite network by assigning boolean values to the `type` node attribute - members of one group should be assigned the value `TRUE` and the others should be assigned the value `FALSE`. For example, if your graph is called `g` and you used the `bioguide_id` values as congress member node names, you would use the following code to make the graph bipartite: `V(g)$type <- V(g)$name %in% congress$bioguide_id`. As we covered in the lab lectures, `V(g)` will return all nodes (also called vertices) from the graph `g` and `V(g)$name` will get the node attribute called `name`, a special node property that uniquely identifies each node. Then the expression `V(g)$name %in% congress$bioguide_id` will return a boolean vector assigning either `TRUE` or `FALSE` to each node depending on whether it is in our list of congress member `bioguide_id`s. Try testing each of these expressions to see what is happening with this code snippet.

```{r}
# Your answer here.
```
<br/>

**5. Create an adjacency matrix from the previous network and use it to make a new graph. Was the bipartite property preserved in the graph created from the adjacency matrix? Why does igraph work this way?**
```{r}
# Your answer here
```
```
Your written answer here
```
<br/>

**6. Starting with our bipartite network, we want to compute a network capturing the number of common committees each member of congress has with each other. To do this, we can use the `bipartite_projection` function. In the congress member network, add gender and age as node properties. We will use this graph for future problems.**

HINT: check out the `witch` parameter of `bipartite_projection`. If you set `which=TRUE`, it will return a network of the nodes which were assigned `TRUE` earlier when you set the type attribute.
```{r}
# Your answer here
```
<br/>


**7. Make a visual of of the congress co-membership network where the node colors are based on the political party of the politican and node size is based on the politician age. For aesthetic purposes, you should try removing edges that are below a certain weight (weight <= 2 seems reasonable). Try two different layouts and discuss their strengths and weaknesses.**

Hint: see some available layouts [here](https://www.data-imaginist.com/2017/ggraph-introduction-layouts/).

Note: it may be difficult to make a clean visualization with so many nodes and edges, but do your best - this is a common task when working with network data. You may also try removing vertices with a small number of edges if it is easier to read.
```{r}
# Your answer here or in text.
```
```
describe strengths and weaknesses here.
```
<br/>


**8. Add the centrality measures from the previous question to the `congress` dataframe. Which politician has the highest strength (weighted degree) centrality, and how do you interpret this value? How about the highest eigenvector centrality?**
```{r}
# your answer here
```
```
written explanation here
```
<br/>

**9. Create a violin plot showing the average centrality (you choose the measure) for men and women, and then do the same for each political party. What can you conclude from these?**
```{r}
# your answer here
```
```
written explanation here
```
<br/>

**10. In last week's lab excerice, you were asked to identify several possible datasets you could use for your final project. Now write two specific data science research questions and describe variables in that dataset that could allow you to answer the questions.**

HINT: **What is a good research question?** A good data science research question specifies a relationship between two or more variables that you can measure. The question "why did the chicken cross the road?" is not a good research question because it does not explicitly describe the relationship between any variables. The question "do chickens cross the road more frequently than raccoons?" is good because it specifies a relationship between the type of animal (chickens and raccoons) and the frequency with which the animal crosses the road. Your question should be answerable given the specific variables available in your dataset.
```
# your answer here
```

